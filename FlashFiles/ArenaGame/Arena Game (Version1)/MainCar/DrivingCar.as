package {	import flash.display.*;	import flash.events.*;	public class DrivingCar extends MovieClip	{		public var refM:MovieClip;		public var speeed:Number = 0;		public var speedMax:Number = 15;		public var speedMaxReverse:Number = -8;		public var speedAcceleration:Number = .50;		public var speedDeceleration:Number = 1;		public var groundFriction:Number = .92;		public var steering:Number = 0;		public var steeringMax:Number = 2.4;		public var steeringAcceleration:Number = .20;		public var steeringFriction:Number = .95;		public var velocityX:Number = 0;		public var velocityY:Number = 0;		public var up:Boolean = false;		public var down:Boolean = false;		public var left:Boolean = false;		public var right:Boolean = false;		public var leftSignal:Boolean = false;		public var rightSignal:Boolean = false;		public var mCarIndRotation:Number;		public function DrivingCar()		{			this.addEventListener(Event.ENTER_FRAME,gLoop);			stage.addEventListener(KeyboardEvent.KEY_DOWN,onMyPress);			stage.addEventListener(KeyboardEvent.KEY_UP,onMyRelease);			refM = MovieClip(this.parent);			refM.carsArray.push(this);		}		function gLoop(myEvent:Event):void		{			mCarIndicatorRotate();			MainCarMovement();			if (this.x < refM.boundyLeft || this.x > refM.boundyRight || this.y < refM.boundyTop || this.y > refM.boundyBottom)			{				refM.mCarInd.alpha = .8;								refM.healthBar.healthState = true;				refM.healthBar.alphaControl = "dull";			}			else			{				refM.mCarInd.alpha = 0;				refM.healthBar.healthState = false;				refM.healthBar.alphaControl = "full";			}			if (this.y < -50)			{				this.y = 750;			}			if (this.y > 750)			{				this.y = -50;			}			if (this.x > 750)			{				this.x = -50;			}			if (this.x < -50)			{				this.x = 750;			}		}		public function mCarIndicatorRotate()		{			mCarIndRotation = Math.round((180 - Math.atan2(this.x - refM.mCarInd.x,this.y - refM.mCarInd.y) * 180 / Math.PI));			refM.mCarInd.rotation = mCarIndRotation;		}		public function MainCarMovement()		{			if (up)			{				if ((speeed < speedMax))				{					speeed +=  speedAcceleration;					if ((speeed > speedMax))					{						speeed = speedMax;					}				}			}			if (down)			{				if ((speeed > speedMaxReverse))				{					speeed -=  speedAcceleration;					if ((speeed < speedMaxReverse))					{						speeed = speedMaxReverse;					}				}			}			if (left)			{				steering -=  steeringAcceleration;				if ((steering > steeringMax))				{					steering = steeringMax;				}			}			if (right)			{				steering +=  steeringAcceleration;				if ((steering <  -  steeringMax))				{					steering =  -  steeringMax;				}			}			speeed *=  groundFriction;			if (((speeed > 0) && speeed < 0.05))			{				speeed = 0;			}			velocityX = Math.sin(this.rotation * Math.PI / 180) * speeed;			velocityY = Math.cos(this.rotation * Math.PI / 180) *  -  speeed;			this.x +=  velocityX;			this.y +=  velocityY;			if ((steering > 0))			{				if ((steering < 0.05))				{					steering = 0;				}			}			else if ((steering < 0))			{				if ((steering > -0.05))				{					steering = 0;				}			}			steering = steering * steeringFriction;			steering -=  (steering * 0.1);			this.rotation +=  steering * speeed;		}		function onMyPress(event:KeyboardEvent):void		{			if (event.keyCode == 32)			{				refM.myColor2 = Math.random() * 0xFFFFFF;				refM.myColorTransform.color = refM.myColor2;				this.body1.transform.colorTransform = refM.myColorTransform;				refM.mCarInd.transform.colorTransform = refM.myColorTransform;			}			if (event.keyCode == 87 || event.keyCode == 38)			{				up = true;				speeed +=  0.1;			}			if (event.keyCode == 83 || event.keyCode == 40)			{				down = true;			}			if (event.keyCode == 65 || event.keyCode == 37)			{				left = true;			}			if (event.keyCode == 68 || event.keyCode == 39)			{				right = true;			}			event.updateAfterEvent();		}		function onMyRelease(event:KeyboardEvent):void		{			if (event.keyCode == 87 || event.keyCode == 38)			{				up = false;			}			if (event.keyCode == 83 || event.keyCode == 40)			{				down = false;			}			if (event.keyCode == 65 || event.keyCode == 37)			{				left = false;			}			if (event.keyCode == 68 || event.keyCode == 39)			{				right = false;			}		}	}}