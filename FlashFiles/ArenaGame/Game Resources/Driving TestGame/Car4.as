package {	import flash.display.MovieClip;	import flash.events.Event;	public class Car4 extends MovieClip	{		var refM:MovieClip;		var moveSpeedMax:Number = 2000;		var rotateSpeedMax:Number = 15;		var decay:Number = .98;				var _dx:Number = 0;		var _dy:Number = 0;		var _vx:Number = 0;		var _vy:Number = 0;		var trueRotation:Number = 0;		var isActive4:Boolean = false;		var car4Count:Number = 0;		var isTrue4:Boolean = true;		var startMove4:Boolean = false;		var carRandomPos:Number = 0;		public function Car4()		{			stage.addEventListener(Event.ENTER_FRAME,gLoop);			refM = MovieClip(this.parent);			refM.carsArray.push(this);		}		function gLoop(event:Event):void		{			refM.car4Text.text = "Car4 " + car4Count;									for (var w:Number = 0; w < refM.carsArray.length; w += 1)			{				if (refM.carsArray[4].hitTestObject(refM.carsArray[0]) || refM.carsArray[4].hitTestObject(refM.carsArray[1]) || refM.carsArray[4].hitTestObject(refM.carsArray[2]) || refM.carsArray[4].hitTestObject(refM.carsArray[3]))				{					refM.carsArray[4].alpha = .5					//isActive4 = false;//					isTrue4 = true;//					startMove4 = false;				}			}			if (isActive4 == false)			{				if (isTrue4 == true)				{					carRandomPos = Math.random() * 1;					carRandomPos = Math.round(carRandomPos);					isTrue4 = false;				}				if (startMove4 == false)				{					if (carRandomPos == 0)					{						this.x = -50;						this.y = 400;						this.rotation = 180;					}					if (carRandomPos == 1)					{						this.x = -50;						this.y = 150;						this.rotation = 180;					}					car4Count += 1					;					if (car4Count > 100)					{						car4Count = 0;						startMove4 = true;					}				}				if (startMove4 == true)				{					isActive4 = true;				}			}			if (isActive4 == true)			{				_dx = this.x - refM.destinationX;				_dy = this.y - refM.destinationY;				var rotateTo:Number = getDegrees(getRadians(_dx,_dy));				if ((rotateTo > this.rotation + 180))				{					rotateTo -=  360;				}				if ((rotateTo < this.rotation - 180))				{					rotateTo +=  360;				}				trueRotation = (rotateTo - this.rotation) / rotateSpeedMax;				this.rotation +=  trueRotation;				_vx +=  (refM.destinationX - this.x) / moveSpeedMax;				_vy +=  (refM.destinationY - this.y) / moveSpeedMax;				_vx *=  decay;				_vy *=  decay;				if ((getDistance(_dx,_dy) < 50))				{					trueRotation *=  .5;				}				this.x +=  _vx;				this.y +=  _vy;				function getDistance(delta_x:Number, delta_y:Number):Number				{					return Math.sqrt((delta_x*delta_x)+(delta_y*delta_y));				}				function getRadians(delta_x:Number, delta_y:Number):Number				{					var r:Number = Math.atan2(delta_y,delta_x);					if (delta_y < 0)					{						r +=  (2 * Math.PI);					}					return r;				}				function getDegrees(radians:Number):Number				{					return Math.floor(radians/(Math.PI/180));				}				if (this.y < -80)				{					this.y = 680;				}				if (this.y > 680)				{					this.y = -80;				}				if (this.x > 880)				{					this.x = -80;				}				if (this.x < -80)				{					this.x = 880;				}			}		}	}}